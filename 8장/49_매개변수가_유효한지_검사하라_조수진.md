# item 49. 매개변수가 유효한지 검사하라

메서드와 생성자 대부분은 입력 매개변수 값이 특정 조건을 만족해야한다. (ex. 인덱스 값은 음수이면 안되고, 객체 참조는 null이 아니어야한다 등) 이런 제약은 반드시 문서화해야 하며 메서드 몸체가 시작되기 전에 검사해야 한다.
⇒ 메서드 몸체가 실행되기 전에 `매개변수를 확인하고 잘못된 값이 넘어왔을 때 즉각적이고 깔끔하게 예외`를 던지도록 코드를 작성한다.

### 예시

```java
/*
* (현재 값 mod m) 값을 반환한다. 이 메서드는
* 항상 음이 아닌 BigInteger를 반환한다는 점에서 remainder 메서드와 다르다.
*
* @param m계수(양수여야 한다.)
* @return 현재 값 mod m
* @throws ArithmeticException m이 0보다 작거나 같으면 발생한다.
*/
public BigInteger mod(BigInteger m) {
	if (m.signum() <= 0)
		throw new ArithmeticException("계수(m)은 양수어야 합니다. " + m);
	... // 계산 수행
}
```

### 매개변수 검사를 제대로 하지 못했을 때

- 메서드가 수행되는 중간에 모호한 예외를 던지며 실패할 수 있다.
- 메서드가 잘 수행되지만 잘못된 결과를 반환할 수 있다.
- 메서드는 문제없이 수행됐지만 실패 원자성이 깨지고 미래의 알 수 없는 시점에 해당 메서드와 관련없는 오류를 낼 수 있다.
⇒ 오류를 발생한 즉시 잡지 못하면 해당 오류를 감지하기 어렵다.

### 문서화

제약과 제약을 어겼을 때 발생하는 예외를 함께 기술한다. `@throws` 자바독 태그를 이용해서 문서화 할 수 있다. 

### 매개변수 유효성 검사

- public, protect API의 경우 유효성 검사가 필요하다.
- 생성자 매개변수 유효성 검사는 클래스 불변식을 어기는 객체가 만들어지지 않게 하기위해 꼭 필요하다.
- 특히, List를 반환하는 등 메서드가 직접 사용하지는 않지만 나중에 쓰기 위해 저장하는 매개변수는 더 신경써서 검사해야한다.
- 유효성 검사 비용이 지나치게 높거나, 메서드 계산 과정에서 암묵적으로 검사가 수행되는 경우 매개변수 유효성 검사를 하지 않을 수 있다. 하지만 실패 원자성에 주의해야한다!
- private, package private 메서드는 assert를 이용해서 유효성 검사할 수 있다.
- assert를 이용했을 때, 실패하면 AssertionError를 던지고 런타임에는 아무 효과도 성능 저하도 없다.(-ea —enableassertions를 설정하면 런타임에도 동작)

### 유용한 유효성 검사 API

- java 7의 java.util.Objects.requireNonNull
    `this.strategy = Objects.requireNonNull(startegy, "전략으로 null이 올 수 없습니다.");`
- java 9의 java.util.Objects.checkFromIndexSize, checkFromToIndex, checkIndex 등

### 정리

- 메서드나 생성자를 작성할 때면 그 매개변수들에 어떤 제약이 있을지 생각해야 한다.
- 제약들을 문서화하고 메서드 코드 시작부분에 명시적으로 검사해야 한다.